<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Declarative Annotations in Eclipse Neon</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://rage5474.github.io/favicon.ico">

    <script type="text/javascript" src="//rage5474.github.io/themes/ichi/assets/js/vendor/fastclick.js?v=1541920820934"></script>
    <script type="text/javascript" src="//rage5474.github.io/themes/ichi/assets/js/vendor/modernizr.js?v=1541920820934"></script>


    <link rel="stylesheet" type="text/css" href="//rage5474.github.io/themes/ichi/assets/css/normalize.css?v=1541920820934" />
    <link rel="stylesheet" type="text/css" href="//rage5474.github.io/themes/ichi/assets/css/foundation.min.css?v=1541920820934" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" type="text/css" href="//rage5474.github.io/themes/ichi/assets/css/outdatedBrowser.min.css?v=1541920820934">
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="//rage5474.github.io/themes/ichi/assets/fonts/foundation-icons/foundation-icons.css?v=1541920820934" />
    <link rel="stylesheet" type="text/css" href="//rage5474.github.io/themes/ichi/assets/css/styles.css?v=1541920820934" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300,700,400|Source+Sans+Pro:300,400,600,700,900,300italic,400italic,600italic,700italic,900italic" />

    <link rel="canonical" href="https://rage5474.github.io/2016/08/29/Declarative-Annotations-in-Eclipse-Neon.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Eclipse RCP Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Declarative Annotations in Eclipse Neon" />
    <meta property="og:description" content="Motivation Many Eclipse RCP applications are using OSGi Services make their application leightweight and flexible. The most convient method is to use OSGi Services in combination with Declarative Services. This allows to specifiy OSGi Services by XML files. Why this can be quite convient can be found here DS@Vogella." />
    <meta property="og:url" content="https://rage5474.github.io/2016/08/29/Declarative-Annotations-in-Eclipse-Neon.html" />
    <meta property="article:published_time" content="2016-08-29T00:00:00.000Z" />
    <meta property="article:tag" content="Eclipse" />
    <meta property="article:tag" content="RCP" />
    <meta property="article:tag" content="Raphael Geissler" />
    <meta property="article:tag" content="OSGi" />
    <meta property="article:tag" content="Declarative Annotations" />
    <meta property="article:tag" content="Eclipse Neon" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Declarative Annotations in Eclipse Neon" />
    <meta name="twitter:description" content="Motivation Many Eclipse RCP applications are using OSGi Services make their application leightweight and flexible. The most convient method is to use OSGi Services in combination with Declarative Services. This allows to specifiy OSGi Services by XML files. Why this can be quite convient can be found here DS@Vogella." />
    <meta name="twitter:url" content="https://rage5474.github.io/2016/08/29/Declarative-Annotations-in-Eclipse-Neon.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Eclipse RCP Blog",
    "author": {
        "@type": "Person",
        "name": "rage5474",
        "image": "https://avatars2.githubusercontent.com/u/12368367?v=4",
        "url": "https://rage5474.github.io/author/rage5474/",
        "sameAs": "http://rage5474.github.io"
    },
    "headline": "Declarative Annotations in Eclipse Neon",
    "url": "https://rage5474.github.io/2016/08/29/Declarative-Annotations-in-Eclipse-Neon.html",
    "datePublished": "2016-08-29T00:00:00.000Z",
    "keywords": "Eclipse, RCP, Raphael Geissler, OSGi, Declarative Annotations, Eclipse Neon",
    "description": "Motivation Many Eclipse RCP applications are using OSGi Services make their application leightweight and flexible. The most convient method is to use OSGi Services in combination with Declarative Services. This allows to specifiy OSGi Services by XML files. Why this can be quite convient can be found here DS@Vogella."
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Eclipse RCP Blog" href="https://rage5474.github.io/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/atom-one-dark.min.css">
</head>
<body class="post-template tag-Eclipse tag-RCP tag-Raphael-Geissler tag-OS-G tag-Declarative-Annotations tag-Eclipse-Neon">

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdate" href="http://outdatedbrowser.com/">Update my browser now</a></p>
</div>

<nav class="top-bar hide-for-large-up" data-topbar >
  <ul class="title-area">
    <li class="name">

    </li>
    <li class="home"><a class="fi-home" href="https://rage5474.github.io"></a></li>
    <li class="toggle-topbar"><a href="#" id="trigger-overlay" class="fi-list"></a></li>
  </ul>

<div class="overlay overlay-scale">
    <button type="button" class="overlay-close">Close</button>
    <nav>
        <ul>
            <li><a href="https://rage5474.github.io">Home</a></li>
        </ul>
    </nav>
</div>

</nav>

<div class="row">

<div class="small-16 medium-16 large-4 columns right head-area" >

<header class="site-head">
    <div class="vertical">
        <div class="site-head-content inner">
            <ul class="side-nav blog-menu show-for-large-up">
                <li><a class="fi-home" href="https://rage5474.github.io"></a></li>
                <li><a class="fi-torso" href="https://rage5474.github.io/about"></a></li>
                <li><a class="fi-mail" href="https://rage5474.github.io/contact"></a></li>
            </ul>
            <a class="blog-logo" href="https://rage5474.github.io"><img alt="Eclipse RCP Blog" src="/images/ich.jpg" alt="Blog Logo" /></a>
            <h1 class="blog-title">Eclipse RCP Blog</h1>
            <hr>
            <p class="blog-description">Yet another blog for Eclipse RCP topics, like good Eclipse RCP architecture, software architecture control, ... </p>
            <div class="blog-network">
<!--                 <a href="#" class="fi-social-pinterest"></a>
                <a href="#" class="fi-social-linkedin"></a>
                <a href="#" class="fi-social-behance"></a>
                <a href="#" class="fi-social-deviant-art"></a>
                <a href="#" class="fi-social-dribbble"></a>
                <a href="#" class="fi-social-flickr"></a>
                <a href="#" class="fi-social-github"></a>
                <a href="#" class="fi-social-skype"></a>
                <a href="#" class="fi-social-snapchat"></a>
                <a href="#" class="fi-social-steam"></a>
                <a href="#" class="fi-social-xbox"></a>
                <a href="#" class="fi-social-reddit"></a> -->
                  <a href="rage5474" class="fi-social-github"></a>
                  <a href="raphael.geissler" class="fi-social-twitter"></a>
            </div>
        </div>
    </div>
</header>

</div>


<div class="small-16 medium-16 large-12 columns main-column left">
    

<main class="content" role="main">

    <article class="post tag-Eclipse tag-RCP tag-Raphael-Geissler tag-OS-G tag-Declarative-Annotations tag-Eclipse-Neon">


            <h1 class="post-title">Declarative Annotations in Eclipse Neon</h1>

            <span class="post-meta label"><time datetime="2016-08-29">29 Aug 2016</time></span>

            <section class="post-content">
                <div class="sect1">
<h2 id="_motivation">Motivation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many Eclipse RCP applications are using OSGi Services make their application leightweight and flexible. The most convient method is to use OSGi Services in combination with Declarative Services. This allows to specifiy OSGi Services by XML files. Why this can be quite convient can be found here <a href="http://www.vogella.com/tutorials/OSGiServices/article.html#declarativeservices">DS@Vogella</a>.
Before Eclipse Neon there were two possibilties to create or modify these XML files.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By Hand - Disadvantage: Error prone.</p>
</li>
<li>
<p>Integration editor - Disadvantages: Error prone on re-factoring, no consistent naming scheme.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>No Eclipse Neon integrated a third solution: Generation of XML files by code annotations. In this blog I want to show more detailled how this can work.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_example">Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Expecting a simple HelloWorld OSGi application, with</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a HelloWorldService and</p>
</li>
<li>
<p>a HelloWorldClient.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The HelloWorldService is exporting following simple interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.osgi.ds.example.helloservice.api;

public interface HelloWorldService {
    // Prints 'Hello + name' to the console
    public void sayHello(String name);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Whenever <code>sayHello</code> is called 'Hello + name' is printed on the console.</p>
</div>
<div class="paragraph">
<p>Here is the corresponding implementation of this OSGi Service. So the implementation is quite straight forward.
Now let us come to the interesting part of this class - the <code>@Component</code> DS Annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.osgi.ds.example.helloservice.impl;

import org.osgi.service.component.annotations.Component;
import my.osgi.ds.example.helloservice.api.HelloWorldService;

@Component
public class HelloWorldServiceImpl implements HelloWorldService {

	@Override
	public void sayHello(String name) {
		System.out.println(("Hello " + name + "!"));
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To register a class as OSGi-Service (Component is used here as synonym) just use <code>@Component</code> as class annotation. That&#8217;s the minimum to register a class as OSGi service. Whenever you save this class, automatically a new XML file <code>my.osgi.ds.example.helloservice.impl.HelloWorldServiceImpl.xml</code> will be generated <code>OSGI-INF</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;scr:component xmlns:scr="http://www.osgi.org/xmlns/scr/v1.1.0" name="my.osgi.ds.example.helloservice.impl.HelloWorldServiceImpl"&gt;
   &lt;service&gt;
      &lt;provide interface="my.osgi.ds.example.helloservice.api.HelloWorldService"/&gt;
   &lt;/service&gt;
   &lt;implementation class="my.osgi.ds.example.helloservice.impl.HelloWorldServiceImpl"/&gt;
&lt;/scr:component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>So in the most cases this should be enough. Look&#8217;s quite easy.</p>
</div>
<div class="paragraph">
<p>Let us have a look on the <code>HelloWorldClientImpl</code>. It&#8217;s the service that is using our <code>HelloWorldService</code>.
At first it has to become also a OSGi service. So <code>@Component`annotation is needed. Then we need the reference to the `HelloWorldService</code>. This is done by a method, which is annotated by <code>@Reference</code>. But here its also a special parameter <code>unbind</code> needed, which also points to the unbind method. So the <code>@Reference</code> method is used inject the <code>HelloWorldService</code> to the <code>HelloWorldClientImpl</code>. In case you have multiple <code>@Reference</code> methods, you should use the <code>@Activate</code> method to start your component. Otherwise it&#8217;s not guaranteed, that all service references were already injected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package my.osgi.ds.example.helloclient.impl;

import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;
import org.osgi.service.component.annotations.Deactivate;
import org.osgi.service.component.annotations.Reference;

import my.osgi.ds.example.helloservice.api.HelloWorldService;

@Component
public class HelloWorldClientImpl {
	private HelloWorldService helloWorldService;

	@Reference(unbind = "unbind")
	public void bind(HelloWorldService helloWorldService) {
		this.helloWorldService = helloWorldService;
	}

	@Activate
	public void start() {
		helloWorldService.sayHello("Mr. X");
	}

	public void unbind(HelloWorldService helloWorldService) {
		this.helloWorldService = null;
	}

	@Deactivate
	public void stop() {
		this.helloWorldService = null;
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again a XML file <code>my.osgi.ds.example.helloclient.impl.HelloWorldClientImpl.xml</code> is generated in the folder <code>OSGI-INF</code>.</p>
</div>
<div class="paragraph">
<p>Content looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;scr:component xmlns:scr="http://www.osgi.org/xmlns/scr/v1.1.0"
	activate="start"
	deactivate="stop"
	name="my.osgi.ds.example.helloclient.impl.HelloWorldClientImpl"&gt;
    &lt;reference
   	bind="bind"
        cardinality="1..1"
        interface="my.osgi.ds.example.helloservice.api.HelloWorldService"
        policy="static"
        unbind="unbind"/&gt;
   &lt;implementation class="my.osgi.ds.example.helloclient.impl.HelloWorldClientImpl"/&gt;
&lt;/scr:component&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advantages">Advantages</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Naming scheme of XML files are always the same.</p>
</li>
<li>
<p>Usability is trivial.</p>
</li>
<li>
<p>Annoations can be easily used for byte code generated traces (I will write another post for this topic!).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_try_it_out">Try it out</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A full example can be found here: <a href="https://github.com/rage5474/rcp.examples/tree/master/ds.annotation.example/my.osgi.ds.example">ds.annotation.example@github</a>.</p>
</div>
</div>
</div>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="https://rage5474.github.io/tag/Eclipse/">Eclipse</a>, <a href="https://rage5474.github.io/tag/RCP/">RCP</a>, <a href="https://rage5474.github.io/tag/Raphael-Geissler/">Raphael Geissler</a>, <a href="https://rage5474.github.io/tag/OS-G/">OSGi</a>, <a href="https://rage5474.github.io/tag/Declarative-Annotations/">Declarative Annotations</a>, <a href="https://rage5474.github.io/tag/Eclipse-Neon/">Eclipse Neon</a></aside>
            </section>
            <hr>
            <footer class="post-footer">

                <section class="share">
                    <h4>Liked this post ? Share it.</h4>
                    <a class="fi-social-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://rage5474.github.io/"
                        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    </a>
                    <a class="fi-social-twitter" href="https://twitter.com/share?text=Declarative%20Annotations%20in%20Eclipse%20Neon&amp;url=https://rage5474.github.io/"
                        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    </a>
                    <a class="fi-social-google-plus" href="https://plus.google.com/share?url=https://rage5474.github.io/"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    </a>
                </section>

                <section class="author">
                    <header>
                        <span>About the author</span>
                    </header>
                    <section>
                        <h4>rage5474</h4>
                        <img src="https://avatars2.githubusercontent.com/u/12368367?v&#x3D;4">
                        
                        <a href="http://rage5474.github.io">http://rage5474.github.io</a>
                    </section>
                    <footer>
                         <p></p>
                    </footer>
                </section>

        <div class="clearfix"></div>
                    <hr>

            </footer>

        <h3 class="title-disqus"><span class="fi-comments"></span>Discussions</h3>




        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'https-rage5474-github-io'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>

</div>

</div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>
       
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

    <!--[if lte IE 8]>
        <script type="text/javascript" src="//rage5474.github.io/themes/ichi/assets/js/outdatedBrowser.min.js?v=1541920820934"></script>
    <![endif]-->
    <script type="text/javascript" src="//rage5474.github.io/themes/ichi/assets/js/min/built.js?v=1541920820934"></script>

    <script>
      $(document).foundation();
    </script>

</body>
</html>
